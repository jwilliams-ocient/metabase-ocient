{
    "version": 2,
    "pipeline_id": "madison_test",
    "source": {
        "type": "s3",
        "endpoint": "http://cos/",
        "bucket": "customer_data",
        "file_groups": {
            "enriched-bof": {
                "type": "lexicographic",
                "prefix": "madison/qts_kafka_connect-20210319/enriched-bof/year=2021/month=03/day=10/hour=06/enriched-bof+4"
            }
        },
        "partitions": 2,
        "partitions_assigned": [
            0,
            1
        ],
        "compression": "gzip"
    },
    "sink": {
        "type": "ocient",
        "remotes": ["127.0.0.1:5050"]
    },
    "workers": 2,
    "transform": {
        "topics": {
            "enriched-bof": {
                "tables": {
                    "metabase.madison.enriched": {
                        "columns": {
                            "time_gmt": "body.time.gmt",
                            "received_ts": "\"X-Mm-Received-Ts\"",
                            "prebid_data": "\"X-Mm-Prebid-Data\"",
                            "aid": "body.aid",
                            "bid": "body.bid",
                            "time_est": "body.time.est",
                            "time_user": "body.time.user",
                            "user_uid": "body.user.uid",
                            "user_cid": "body.user.cid",
                            "pmp_e": "body.attrs[?dim == `4`].vals[]",
                            "region": "body.attrs[?dim == `5`].vals[]",
                            "domain": "body.attrs[?dim == `11`].vals[] | [0]",
                            "mobile_appid": "body.attrs[?dim == `13`].vals[] | [0]",
                            "market": "body.attrs[?dim == `14`].vals[] | [0]",
                            "fold_position": "body.attrs[?dim == `15`].vals[] | [0]",
                            "browser_lang": "body.attrs[?dim == `16`].vals[]",
                            "transparency": "body.attrs[?dim == `18`].vals[] | [0]",
                            "connection_speed": "body.attrs[?dim == `19`].vals[] | [0]",
                            "isp": "body.attrs[?dim == `20`].vals[] | [0]",
                            "custom_sitelist": "body.attrs[?dim == `21`].vals[]",
                            "universal_blocklist": "body.attrs[?dim == `22`].vals[] | [0]",
                            "browser": "body.attrs[?dim == `24`].vals[] | [0]",
                            "os": "body.attrs[?dim == `25`].vals[] | [0]",
                            "device": "body.attrs[?dim == `26`].vals[]",
                            "wurfl": "body.attrs[?dim == `29`].vals[]",
                            "video_contentinitiation": "body.attrs[?dim == `30`].vals[] | [0]",
                            "video_startswithaudio": "body.attrs[?dim == `31`].vals[] | [0]",
                            "video_runtime_adposition": "body.attrs[?dim == `32`].vals[] | [0]",
                            "video_displaysize": "body.attrs[?dim == `33`].vals[] | [0]",
                            "video_mediatype": "body.attrs[?dim == `34`].vals[]",
                            "video_isskippable": "body.attrs[?dim == `35`].vals[] | [0]",
                            "video_linearformat": "body.attrs[?dim == `36`].vals[] | [0]",
                            "creative_size": "body.attrs[?dim == `40`].vals[]",
                            "creative_ismraid": "body.attrs[?dim == `43`].vals[] | [0]",
                            "video_maxbitrate": "body.attrs[?dim == `44`].vals[] | [0]",
                            "video_minbitrate": "body.attrs[?dim == `45`].vals[] | [0]",
                            "creative_issecure": "body.attrs[?dim == `46`].vals[] | [0]",
                            "creative_isflashless": "body.attrs[?dim == `47`].vals[] | [0]",
                            "creative_isexpandable": "body.attrs[?dim == `48`].vals[] | [0]",
                            "expansion_trigger": "body.attrs[?dim == `49`].vals[]",
                            "expansion_direction": "body.attrs[?dim == `50`].vals[]",
                            "creative_type": "body.attrs[?dim == `51`].vals[]",
                            "inventory_type": "body.attrs[?dim == `52`].vals[] | [0]",
                            "channels": "body.attrs[?dim == `55`].vals[] | [0]",
                            "thirdparty_audience": "array_cap(body.attrs[?dim == `2`].vals[], `8000`)",
                            "contextual": "array_cap(map(&join(':',@), zip(body.attrs[?dim == `28`].[to_array_length(to_string(v), length(vals))][][], body.attrs[?dim == `28`].vals[])), `5000`)",
                            "day_part": "body.attrs[?dim == `17`].vals[] | [0]",
                            "dmacode": "body.attrs[?dim == `6`].vals[] | [0]",
                            "exchange": "body.attrs[?dim == `12`].vals[] | [0]",
                            "zipcode": "body.attrs[?dim == `7`].vals[] | [0]"
                        }
                    }
                }
            }
        }
    }
}
